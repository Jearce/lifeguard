{% extends 'sidebar.html' %}
{% load crispy_forms_tags %}

{% block title %}
<title>Enrollment Cart</title>

<style>
<style>
	.schedule {
		display: flex;
		flex-direction: column;
	}

	.days {
		display: flex;
		justify-content: flex-start;
	}

	.date-container {
		display: flex;
		flex-direction: column;
		align-items: center;
		border: 1px solid grey;
		border-radius: 5px;
	}

	.date-container * {
		width: 100%;
		text-align: center;
		padding: 10px;
	}

	.month {
		background-color: black;
		color: white;
	}

	.day-of-month {
		font-size: 26px;
		font-weight: bold;
		padding-bottom: 0px;
	}

	.day-of-week {
		padding: 0px;
		font-size: 15px;
	}

	.time {
		font-weight: bold;
	}

	.year {
		font-size: 20px;
	}

	p {
		font-size: 20px;
		margin-left: 5px;
	}

	@media only screen and (max-width: 600px) {
		.days {
			flex-direction: column;
		}
	}
</style>
</style>
{% endblock title %}

{% block pagecontent %}
<div class="container">
	{% if request.user.lifeguard.enroll_set.count > 0 %}
	<h1 class="text-center mb-3">Enrollment Cart</h1>
	{% for enrollment in enrolled_classes %}
		{% if not enrollment.paid %}
			{% with class=enrollment.lifeguard_class %}
			<div class="w-25 card border-dark mb-3 mt-3 center-form">
				<div class="card-header">
					<h3>{{ class.course }}</h3>
				</div>
				<div class="card-body">
					<ul class="list-group list-group-flush">
						<li class="list-group-item p-2">
							<div class="schedule">
								<div>
									<h5>Schedule for this class</h5>
								</div>
								<div class="days">
									{% for class_session in class.get_sessions %}
										<div class="date-container">
											<div class="month">
												{{ class_session.date|date:"F"|upper }}
											</div>
											<div>
												<div class="day-of-month">
													{{ class_session.date|date:"n" }}
												</div>
												<div class="day-of-week">
													{{ class_session.date|date:"l" }}
												</div>
											</div>
											<div class="time">
												{{ class_session.start_time|date:"P" }} - {{ class_session.end_time|date:"P"}}
											</div>
											<div class="year">
												{{ class_session.date|date:"Y" }}
											</div>
										</div>
									{% endfor %}
									<div>
								</div>
							</div>
						</li>
						<li class="list-group-item">
							<div class="d-flex justify-content-between">
								<p>Cost {% if request.user.is_employee %} (employee discount applied) {% endif %}</p>
								<p>
									{% if request.user.is_employee %}
									${{ class.employee_cost }}
									{% else %}
									${{ class.cost }}
									{% endif %}
								</p>
							</div>
						</li>
					</ul>
				</div>
				<div class="card-footer text-center">
					<form method="post" action="{% url 'payment:drop_enrollment' enrollment.pk %}">
						{% csrf_token %}
						<input type="submit" value="drop enrollment" class="btn btn-outline-dark btn-block">
					</form>
				</div>
			</div>
			{% endwith %}
		{% endif %}
	{% endfor %}
	<a href="{% url 'payment:lifeguard_checkout' %}"
		id="id_continue_to_checkout"
	role="button"
 class="w-25 btn btn-primary btn-lg btn-block center-form mt-3 mb-3">
		continue to checkout
	</a>
	{% else %}
	<div class="w-25 alert alert-primary center-form text-center" role="alert">
		<h4>You have no classes in your enrollment cart. You can enroll
			<a href="{% url 'lifeguard:classes' %}" class="alert-link">here</a>.</h4>
	</div>
	{% endif %}
</div>
{% endblock pagecontent %}
